<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Bandwidth Support Dashboard</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@picocss/pico@2/css/pico.min.css"/>
    <style>
        body > main { padding: 2rem; max-width: 1200px; }
        .error { background-color: var(--pico-form-element-invalid-background-color); color: var(--pico-form-element-invalid-color); padding: 1rem; border-radius: var(--pico-border-radius); }
        .highlight { background-color: var(--pico-color-green-100); }
        .timeline { list-style-type: none; padding-left: 0; }
        .timeline li { padding-left: 2rem; border-left: 3px solid var(--pico-primary); position: relative; padding-bottom: 1.5rem; margin-left: 1rem; }
        .timeline li::before { content: '✓'; position: absolute; left: -12px; top: 0; background: var(--pico-primary); color: white; width: 24px; height: 24px; border-radius: 50%; text-align: center; line-height: 24px; }
        .sent { color: var(--pico-color-azure-600); }
        .loader { border: 4px solid #f3f3f3; border-top: 4px solid #3498db; border-radius: 50%; width: 30px; height: 30px; animation: spin 1s linear infinite; margin: 20px auto; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        pre { background-color: #f5f5f5; padding: 1rem; border-radius: var(--pico-border-radius); white-space: pre-wrap; word-wrap: break-word; }
        .grid-2 { display: grid; grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); grid-gap: 2rem; }
        section[role="tabpanel"] { display: none; padding: 1.5rem 0; border-top: 1px solid var(--pico-muted-border-color);}
        section[role="tabpanel"].active { display: block; }
        [role="tab"] { font-weight: bold; }
        [role="tab"][aria-selected="true"] { background-color: var(--pico-primary-background); }
    </style>
</head>
<body>
<main class="container">
    <hgroup><h1>Bandwidth Support Dashboard</h1><p>A unified interface for messaging and analysis tools.</p></hgroup>
    <div role="tablist" class="grid">
        <button role="tab" aria-selected="true" data-target="dlr-tester">DLR Tester</button>
        <button role="tab" data-target="bulk-tester">Bulk Tester</button>
        <button role="tab" data-target="mms-analyzer">MMS Analysis</button>
    </div>
    
    <section role="tabpanel" id="dlr-tester" class="active">
        <article><h2>Advanced Messaging DLR Tester</h2><form action="/run_test" method="post"><fieldset><legend>From Number Type</legend><label for="tfn"><input type="radio" id="tfn" name="from_number_type" value="tf" checked> Toll-Free</label><label for="10dlc"><input type="radio" id="10dlc" name="from_number_type" value="10dlc"> 10DLC</label></fieldset><label for="destination_number">Destination Phone Number</label><input type="text" id="destination_number" name="destination_number" placeholder="+15551234567" required><fieldset><legend>Message Type</legend><label for="sms"><input type="radio" id="sms" name="message_type" value="sms" checked> SMS</label><label for="mms"><input type="radio" id="mms" name="message_type" value="mms"> MMS</label></fieldset><label for="message_text">Text Message</label><textarea id="message_text" name="message_text" placeholder="Enter your text caption here..."></textarea><button type="submit">Run DLR Test</button></form></article>
    </section>
    
    <section role="tabpanel" id="bulk-tester">
        <article><h2>Bulk Performance Tester</h2><p>This tool will send messages from your TF and 10DLC numbers to the following destinations:</p>{% if numbers %}<ul>{% for number, name in numbers %}<li>{{ number }} {% if name %}({{ name }}){% endif %}</li>{% endfor %}</ul>{% else %}<p><em>No destination numbers configured.</em></p>{% endif %}<form action="/run_bulk_test" method="post"><button type="submit" {% if not numbers %}disabled{% endif %}>Start Performance Test</button></form></article>
    </section>
    
    <section role="tabpanel" id="mms-analyzer">
        <article><h2>MMS Media Analysis Tool</h2><p>Enter a media URL to check its technical details and compare against carrier limits.</p><form action="/run_analysis" method="post"><label for="media_url">Media URL</label><input type="text" id="media_url" name="media_url" placeholder="https://.../image.png" required><button type="submit">Analyze Media</button></form></article>
    </section>
</main>
<script>
    document.addEventListener('DOMContentLoaded', () => {
        const tabs = document.querySelectorAll('[role="tab"]');
        const tabPanels = document.querySelectorAll('[role="tabpanel"]');
        
        function activateTab(targetId) {
            tabs.forEach(t => {
                const isSelected = t.getAttribute('data-target') === targetId;
                t.setAttribute('aria-selected', String(isSelected));
            });
            tabPanels.forEach(p => {
                const isSelected = p.getAttribute('id') === targetId;
                p.classList.toggle('active', isSelected);
            });
        }
        
        tabs.forEach(tab => {
            tab.addEventListener('click', (e) => {
                activateTab(e.target.getAttribute('data-target'));
                window.location.hash = e.target.getAttribute('data-target');
            });
        });

        // Activate tab based on URL hash or default to first tab
        const hash = window.location.hash.substring(1);
        const targetTabId = hash || (tabs.length > 0 ? tabs[0].getAttribute('data-target') : null);
        if(targetTabId) {
            activateTab(targetTabId);
        }
    });
</script>
</body>
</html>
"""

#### `templates/result_page.html`
Create this second file inside the `templates` directory.
```html
<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Result</title>
    <link rel="stylesheet" href="[https://cdn.jsdelivr.net/npm/@picocss/pico@2/css/pico.min.css](https://cdn.jsdelivr.net/npm/@picocss/pico@2/css/pico.min.css)"/>
    <style>
        body > main { padding: 2rem; max-width: 1200px; }
        .error { background-color: var(--pico-form-element-invalid-background-color); color: var(--pico-form-element-invalid-color); padding: 1rem; border-radius: var(--pico-border-radius); }
        .highlight { background-color: var(--pico-color-green-100); }
        .timeline { list-style-type: none; padding-left: 0; }
        .timeline li { padding-left: 2rem; border-left: 3px solid var(--pico-primary); position: relative; padding-bottom: 1.5rem; margin-left: 1rem; }
        .timeline li::before { content: '✓'; position: absolute; left: -12px; top: 0; background: var(--pico-primary); color: white; width: 24px; height: 24px; border-radius: 50%; text-align: center; line-height: 24px; }
        .sent { color: var(--pico-color-azure-600); }
        .loader { border: 4px solid #f3f3f3; border-top: 4px solid #3498db; border-radius: 50%; width: 30px; height: 30px; animation: spin 1s linear infinite; margin: 20px auto; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        pre { background-color: #f5f5f5; padding: 1rem; border-radius: var(--pico-border-radius); white-space: pre-wrap; word-wrap: break-word; }
        .grid-2 { display: grid; grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); grid-gap: 2rem; }
    </style>
</head>
<body>
<main class="container">
    <nav>
        <ul><li><strong>Bandwidth Tools</strong></li></ul>
        <ul>
            <li><a href="/">DLR Tester</a></li>
            <li><a href="/bulk">Bulk Tester</a></li>
            <li><a href="/analyze">MMS Analysis</a></li>
        </ul>
    </nav>
    <article>
        {# DLR Test Result #}
        {% if result_type == 'dlr' %}
            <h2>Test Result</h2>
            {% if result_data.error %}<p class="error"><strong>Error:</strong><br>{{ result_data.error }}</p>
            {% elif not is_complete and message_type == "mms" and result_data.events.sent %}<h3 class="sent">✅ MMS Sent Successfully!</h3><p><strong>Message ID:</strong> {{ result_data.message_id }}</p><hr><p><strong>Note:</strong> A 'message-delivered' report was not received within the 60-second timeout.</p>
            {% elif not is_complete %}<p class="error"><strong>Error:</strong><br>TIMEOUT: No final webhook was received.</p>
            {% else %}
                <h3>DLR Timeline</h3>
                <ul class="timeline">
                    <li><strong>Message Sent to API</strong><br>Timestamp: {{ result_data.events.get('sent_str', 'N/A') }}</li>
                    {% if result_data.events.sending %}<li><strong>Sent to Carrier</strong> (Leg 1 Latency: {{ "%.2f"|format(result_data.events.sending_latency) }}s)<br>Timestamp: {{ result_data.events.get('sending_str', 'N/A') }}</li>{% endif %}
                    {% if result_data.events.delivered %}<li><strong>Delivered to Handset</strong> (Leg 2 Latency: {{ "%.2f"|format(result_data.events.delivered_latency) }}s)<br>Timestamp: {{ result_data.events.get('delivered_str', 'N/A') }}</li>{% endif %}
                </ul><hr>
                <h4>Total End-to-End Latency: {{ "%.2f"|format(result_data.events.total_latency) }} seconds</h4>
                <p><strong>Message ID:</strong> {{ result_data.message_id }}</p>
            {% endif %}<br><a href="/" role="button" class="secondary">Back to Dashboard</a>
        
        {# Bulk Test Result #}
        {% elif result_type == 'bulk' %}
            <div id="results-article"><hgroup><h2>Bulk Test Results</h2><p id="status-text">Tests in progress...</p></hgroup><div class="loader" id="loader"></div><div class="grid"><div id="sms-10dlc-results" style="display:none;"><h3>SMS Results (10DLC)</h3><figure><table id="sms-10dlc-table"></table></figure></div><div id="sms-tf-results" style="display:none;"><h3>SMS Results (Toll-Free)</h3><figure><table id="sms-tf-table"></table></figure></div></div><div class="grid"><div id="mms-10dlc-results" style="display:none;"><h3>MMS Results (10DLC)</h3><figure><table id="mms-10dlc-table"></table></figure></div><div id="mms-tf-results" style="display:none;"><h3>MMS Results (Toll-Free)</h3><figure><table id="mms-tf-table"></table></figure></div></div><br><a href="/" role="button" class="secondary">Back to Dashboard</a></div>
            <script>
                const batchId = '{{ batch_id }}';
                function buildTable(data, tableId) {
                    let table = document.getElementById(tableId);
                    table.innerHTML = `<thead><tr><th>To</th><th>Carrier</th><th>Status</th><th>Latency (s)</th></tr></thead>`;
                    let tbody = document.createElement('tbody');
                    let bestLatency = Infinity;
                    if (data.length > 0) { const delivered = data.filter(r => r.latency !== null); if (delivered.length > 0) { bestLatency = Math.min(...delivered.map(r => r.latency)); }}
                    for (const row of data) {
                        let tr = document.createElement('tr');
                        if (row.latency === bestLatency) { tr.classList.add('highlight'); }
                        tr.innerHTML = `<td>${row.to_num}</td><td>${row.carrier_name}</td><td>${row.status}</td><td>${row.latency !== null ? row.latency.toFixed(2) : 'N/A'}</td>`;
                        tbody.appendChild(tr);
                    }
                    table.appendChild(tbody);
                }
                function updateResults(data) {
                    const sections = {"sms-10dlc": data.sms.dlc, "sms-tf": data.sms.tf, "mms-10dlc": data.mms.dlc, "mms-tf": data.mms.tf};
                    for (const key in sections) { if (sections[key].length > 0) { document.getElementById(key + '-results').style.display = 'block'; buildTable(sections[key], key + '-table'); }}
                }
                const interval = setInterval(() => {
                    fetch(`/api/bulk_status/${batchId}`).then(response => response.json()).then(data => {
                        updateResults(data.results);
                        if (data.is_complete) {
                            document.getElementById('loader').style.display = 'none';
                            document.getElementById('status-text').innerText = 'All tests are complete.';
                            clearInterval(interval);
                        }
                    });
                }, 3000);
            </script>

        {# Analysis Result #}
        {% elif result_type == 'analysis' %}
            <div id="results-article"><hgroup><h2>Analysis Report</h2><p id="status-text">Analysis in progress...</p></hgroup><div class="loader" id="loader"></div><div id="analysis-content" style="display:none;"></div></div>
            <script>
                const analysisId = '{{ analysis_id }}';
                const analysisInterval = setInterval(() => {
                    fetch(`/api/analysis_status/${analysisId}`).then(response => response.json()).then(data => {
                        if (data.status === 'complete') {
                            document.getElementById('loader').style.display = 'none';
                            document.getElementById('status-text').innerText = 'Analysis complete.';
                            const contentDiv = document.getElementById('analysis-content');
                            if (data.error) {
                                contentDiv.innerHTML = `<p class="error"><strong>Error:</strong> ${data.error}</p>`;
                            } else {
                                let technicalChecksHtml = '<h4>Technical Details</h4><ul>' + data.checks.map(c => `<li>${c.icon} ${c.message}</li>`).join('') + '</ul>';
                                let spamChecksHtml = '<h4>Spam Risk Analysis</h4><ul>' + data.spam_checks.map(c => `<li>${c.icon} ${c.message}</li>`).join('') + '</ul>';
                                let carrierHtml = '<h4>Carrier Compatibility</h4><figure><table><thead><tr><th>Carrier</th><th>Status</th><th>Note</th></tr></thead><tbody>' + data.analysis.map(c => `<tr><td><strong>${c.name}</strong></td><td>${c.status === 'OK' ? '✅ OK' : '❌ REJECT'}</td><td>${c.note}</td></tr>`).join('') + '</tbody></table></figure>';
                                let previewHtml = data.show_preview ? `<hr><h4>Media Preview</h4><figure><img src="${data.url}" alt="Media Preview" style="max-width:100%;"></figure>` : '';
                                contentDiv.innerHTML = `<div class="grid-2">${technicalChecksHtml}${spamChecksHtml}</div>${carrierHtml}${previewHtml}`;
                            }
                            contentDiv.style.display = 'block';
                            clearInterval(analysisInterval);
                        }
                    });
                }, 2000);
            </script>
        {% endif %}
    </article>
""" + HTML_FOOTER
